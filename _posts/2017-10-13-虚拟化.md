# 虚拟化
在没有虚拟化的时候，所有的服务都是直接跑在物理机上面，这样难免会照成资源的浪费，因为大部分时间，你的应用是无法跑满物理机的CPU，内存，网络资源的；如何提高物理机资源的利用率，从而降低硬件的投入，虚拟化方案完美的解决了这个问题；

通过虚拟化，可以虚拟出多个来宾系统，在来并系统中去部署应用，一个物理机上可以运行多个来宾系统，从而提高了物理机资源的利用率；

虚拟化的方案有多种，我们具体来介绍下几类虚拟化方案

## 硬件仿真
这种虚拟化方式最为彻底，最为复杂，其实是在宿主机系统上创建一个虚拟机模拟出所有它想要的硬件设备；好处显而易见，你可以在这个物理机上运行任何你想要的操作系统；

为了更好理解概念，举个例子：可以理解为在一个制造自行车的生产线上，通过仿真，现在你可以制造摩托车了；

但是这种方式的最主要问题就是性能问题，因为做了完整的仿真，所以对于指令的执行速度相对于运行在裸机上是有很大的损耗的；

## 完全虚拟化
不同于硬件仿真，完全虚拟化是在硬件和来宾系统之间虚拟化出了一个协调层（ hypervisor ），提供来宾系统和物理硬件之间的访问协调；完全虚拟化不需要对来宾操作系统做任何改造，只需要底层硬件支持即可；

但是为了支持完全虚拟化，对硬件也提出了一定的要求，针对CPU这块，需要支持 Intel VT 和 AMD-V；
> 对于x86的服务器，存在一些缺陷，在虚拟化时候会产生一些问题，针对同一个操作指令，返回的结果会依赖于当前运行模式；为了解决这个问题，需要相应的硬件厂商做一些优化，从而可以很好的支持虚拟化的协调层（ hypervisor ）；参见，[虚拟linux](https://www.ibm.com/developerworks/cn/linux/l-linuxvirt/)

为了更好理解概念，举个例子：可以理解为在一个制造儿童自行车的生产线上，通过虚拟化，现在你可以山地自行车了；

优势显而易见，比硬件仿真肯定是快很多，但是比直接裸设备的读取，那还是有一定的损耗的，毕竟进行一层的协调转换；

## 半虚拟化
半虚拟化和完全虚拟化其实很类似，它也是虚拟化出了一个协调层，提供来宾系统的共享访问；唯一的区别在于，完全虚拟化不需要针对来宾操作系统做任何改造，只要底层硬件支持即可；但是对于半虚拟化，部分的虚拟化工作交给了来宾操作系统，所以需要对来宾操作系统做一些改造，从而使它自己清楚知道自己是处于虚拟化环境；

半虚拟化的主要思想在于，由于虚拟化，势必会造成性能损失，所以希望有一些操作直接可以操作底层的硬件，从而可以提高性能；

为了更好的理解概念，举个例子：可以理解为正常生产自行车的企业，然后接到了新的单子，生产共享单车，原先的很多东西是可以复用的；

它的优势就在于快，可以获得近乎裸机的性能；

## 操作系统虚拟化
这个技术其实就是针对每一个应用进行了空间隔离，每一个应用有一个自己独立的命名空间，只是做到了简单的应用隔离，但是底层使用的操作系统都是共享的；

为了更好理解概念，举个例子：可以理解为在一个自行车生产企业里面，有多条业务线，一条是生产共享单车的，一条是生产儿童自行车的，一条是生产山地自行车的；

优点显而易见，可以获得物理机原始的性能；但是，这个操作系统需要做一些修改，才能支持操作系统虚拟化；

# Tips
* [虚拟化技术比较](http://virt.kernelnewbies.org/TechComparison)
* [虚拟Linux](https://www.ibm.com/developerworks/cn/linux/l-linuxvirt/)
