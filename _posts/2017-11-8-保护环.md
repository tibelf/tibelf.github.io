# 保护环 - protection ring
> 在计算机科学中，分级保护域（hierarchical protection domains），也被成为保护环，是一种保护数据和功能免受错误和恶意行为破外的机制

***x86 架构在保护模式下的特权环***
![protection ring](https://github.com/tibelf/image/raw/master/image/protection%20ring.png)

在计算机系统中，提供了不同级别的资源读取权限。

不过，在环之间也预留了特殊的后门，允许外部的环通过预定义的方式访问内部环的资源，而不是任意的使用。不过考虑到安全问题，这个后面的权限也需要控制好。比如，如果你是一个照相应用程序，运行在特权等级为3的级别，在未经用户的允许下是不能去调用照相机这个硬件设备的，因为硬件设备是在特权等级1的级别。

## 模式
### 管理程序模式
最近来自Intel和AMD的CPU为虚拟机管理程序提供x86虚拟化指令来控制Ring 0硬件访问。 虽然它们互不兼容，但英特尔VT-x（代号“Vanderpool”）和AMD-V（代号“Pacifica”）都创建了一个新的“Ring -1”，以便来宾操作系统可以本机运行Ring 0操作，而不会影响其他宾客系统或主机操作系统；
> 为了协助虚拟化，VT 和 Pacifica 都植入了新的特权指令在 Ring 0 之下，一共增加了 9 个新的机器代码指令，仅仅工作在”Ring -1“，旨在被管理程序所调用；


## 特权等级
大多数现代的操作系统使用等级 0 来执行内核操作，而等级 3 来执行应用程序；任何资源如果是在等级 n 执行的，那么就可以在等级 0 ~ n 执行；如果一个特权级别低的进程去尝试访问特权级别高的进程，那么 OS 就会收到保护错误信息。

[Protection ring](https://en.wikipedia.org/wiki/Protection_ring)
